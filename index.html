<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë°ë¸”ìŠ¤ í”Œëœ ê¸°ì‚¬ì˜ ì—¬í–‰ ê²Œì„ â€“ ë‚˜ì´íŠ¸ íˆ¬ì–´ í¼ì¦</title>
  <style>
    :root {
      --tile-size: 90px;
      --font-scale: 0.3;
      --color-unvisited: #A6C8FF;
      --color-visited: #6EA8FF;
      --color-active: #FFB74D;
      --color-button: #FF8C00;
      --color-button-hover: #e07b00;
    }
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 2em;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 0.2em;
    }
    h2 {
      font-size: 1.2rem;
      margin-top: 0;
      color: #555;
    }
    .controls {
      margin: 1em 0;
    }
    select, button {
      font-size: 1rem;
      padding: 0.5em 1em;
      margin: 0 0.3em;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .board {
      display: inline-grid;
      gap: 4px;
      border: 2px solid #333;
      padding: 4px;
      margin-bottom: 1em;
    }
    .tile {
      width: var(--tile-size);
      height: var(--tile-size);
      background: var(--color-unvisited);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: calc(var(--tile-size) * var(--font-scale));
      cursor: pointer;
      user-select: none;
      transition: filter 0.2s;
    }
    .tile:hover {
      filter: brightness(1.1);
    }
    .tile.visited {
      background: var(--color-visited);
    }
    .tile.active {
      background: var(--color-active);
    }
    .status {
      font-size: 1.2rem;
      margin-bottom: 1em;
    }
    .strategy-button {
      display: inline-block;
      background: var(--color-button);
      color: #fff;
      padding: 0.7em 1.5em;
      border-radius: 4px;
      text-decoration: none;
      font-size: 1.1rem;
      transition: background 0.2s;
    }
    .strategy-button:hover {
      background: var(--color-button-hover);
    }
    @media (max-width: 600px) {
      :root { --tile-size: 60px; }
    }
  </style>
</head>
<body>
  <h1>ë°ë¸”ìŠ¤ í”Œëœ ê¸°ì‚¬ì˜ ì—¬í–‰ ê²Œì„</h1>
  <h2>ë‚˜ì´íŠ¸ íˆ¬ì–´ í¼ì¦</h2>

  <div class="controls">
    ì²´ìŠ¤íŒ í¬ê¸°:
    <select id="size-select">
      <option>5 Ã— 5</option>
      <option>6 Ã— 6</option>
      <option>7 Ã— 7</option>
      <option>8 Ã— 8</option>
    </select>
    <button id="start-btn">ê²Œì„ ì‹œì‘</button>
    <button id="back-btn" disabled>ë’¤ë¡œ ê°€</button>
    <button id="hint-btn" disabled>íŒíŠ¸ ë³´ê¸°</button>
  </div>

  <div id="board" class="board"></div>

  <div class="status">
    ì´ë™ íšŸìˆ˜: <span id="move-count">0</span> / <span id="max-count">0</span>
  </div>

  <a href="https://blog.naver.com/kimsol1015/223862326616" target="_blank"
     class="strategy-button">ê²Œì„ ê³µëµ ë³´ê¸°</a>

  <script>
    const boardEl = document.getElementById('board');
    const startBtn = document.getElementById('start-btn');
    const backBtn = document.getElementById('back-btn');
    const hintBtn = document.getElementById('hint-btn');
    const sizeSelect = document.getElementById('size-select');
    const moveCountEl = document.getElementById('move-count');
    const maxCountEl = document.getElementById('max-count');

    let size, maxMoves, moves, path, visited;

    function initBoard() {
      boardEl.innerHTML = '';
      boardEl.style.gridTemplateColumns = `repeat(${size}, auto)`;
      visited = Array.from({ length: size }, () => Array(size).fill(false));
      path = [];
      moves = 0;
      moveCountEl.textContent = moves;
      maxCountEl.textContent = maxMoves;
      backBtn.disabled = true;
      hintBtn.disabled = true;

      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.dataset.r = r;
          tile.dataset.c = c;
          tile.textContent = r * size + c + 1;
          tile.addEventListener('click', () => onTileClick(r, c));
          boardEl.appendChild(tile);
        }
      }
    }

    function onTileClick(r, c) {
      if (!path.length) {
        startTour(r, c);
      } else if (isValidMove(r, c)) {
        moveKnight(r, c);
      }
    }

    function startTour(r, c) {
      size = parseInt(sizeSelect.value);
      maxMoves = size * size;
      initBoard();

      setActive(r, c);
      visited[r][c] = true;
      path.push([r, c]);
      updateButtons();
    }

    function isValidMove(r, c) {
      const [pr, pc] = path[path.length - 1];
      const dr = Math.abs(pr - r), dc = Math.abs(pc - c);
      return !visited[r][c] &&
             ((dr === 1 && dc === 2) || (dr === 2 && dc === 1));
    }

    function moveKnight(r, c) {
      const [pr, pc] = path[path.length - 1];
      getTile(pr, pc).classList.add('visited');
      getTile(pr, pc).classList.remove('active');

      setActive(r, c);
      visited[r][c] = true;
      path.push([r, c]);
      moves++;
      moveCountEl.textContent = moves;
      backBtn.disabled = false;
      hintBtn.disabled = false;

      if (moves + 1 === maxMoves) {
        setTimeout(() => alert('ì„±ê³µí–ˆìŠµë‹ˆë‹¤! ğŸ‰'), 100);
      }
      updateButtons();
    }

    function setActive(r, c) {
      getTile(r, c).classList.add('active');
    }

    function getTile(r, c) {
      return boardEl.querySelector(`.tile[data-r="${r}"][data-c="${c}"]`);
    }

    function undo() {
      if (path.length < 2) return;
      const [r, c] = path.pop();
      visited[r][c] = false;
      getTile(r, c).classList.remove('active');
      moves--;
      moveCountEl.textContent = moves;
      const [pr, pc] = path[path.length - 1];
      setActive(pr, pc);
      backBtn.disabled = path.length < 2;
    }

    function updateButtons() {
      backBtn.disabled = path.length < 2;
      hintBtn.disabled = moves + 1 === maxMoves;
    }

    startBtn.addEventListener('click', () => {
      size = parseInt(sizeSelect.value);
      maxMoves = size * size;
      initBoard();
      startBtn.disabled = true;
      sizeSelect.disabled = true;
    });

    backBtn.addEventListener('click', undo);
    hintBtn.addEventListener('click', () => {
      // íŒíŠ¸ ë¡œì§ ì¶”ê°€ ê°€ëŠ¥
      alert('íŒíŠ¸ ê¸°ëŠ¥ì€ ê³§ ì œê³µë  ì˜ˆì •ì…ë‹ˆë‹¤.');
    });
  </script>
</body>
</html>